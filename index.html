<script type="text/javascript" src="html5-qrcode.min.js"></script>
<script type="text/javascript" src="data.json"></script>


<div style="width: 500px center" id="reader"></div>
<script>
    var moldes = JSON.parse(data);

    var html5QrcodeScanner = new Html5QrcodeScanner(
        "reader", { fps: 30, qrbox: 600 });

    function onScanSuccess(decodedText, decodedResult) {
        // Handle on success condition with the decoded text or result.
        console.log(`Scan result: ${decodedText}`, decodedResult);

        html5QrcodeScanner.clear();
        var moldeNum = decodedText.split(";")[0];
        var partNum = decodedText.split(";")[1];
        console.log(`Molde: ${moldeNum}`);
        console.log(`Part: ${partNum}`);

        moldes.forEach(molde => {
            if (moldeNum == molde.name) {
                console.log(`Descrição: ${molde.description}`);
                molde.parts.forEach(part => {
                    if (partNum == part.num) {
                        console.log("tag");
                        arrayDetalhes = ["Peça: " + part.num, "Nome: " + part.nome, "Quantidade: " + part.quantidade, "Dim/Ref: " + part.dimref, "Material: " + part.material, "Observações: " + part.obs];
                        alert([''].concat(arrayDetalhes).join('\n').trim());
                    }
                });
            }


        });
        location.reload();
    }
    html5QrcodeScanner.render(onScanSuccess);
</script>